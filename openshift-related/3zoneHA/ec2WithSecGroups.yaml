{
  "AWSTemplateFormatVersion": "2010-09-09",
  "Mappings": {
    "AWSRegion2AZ": {
      "us-east-1": {
        "1": "us-east-1b",
        "2": "us-east-1c",
        "3": "us-east-1d",
        "4": "us-east-1e",
        "5": "us-east-1f"
      },
      "us-east-2": {
        "1": "us-east-2a",
        "2": "us-east-2b",
        "3": "us-east-2c"
      },
      "us-west-1": {
        "1": "us-west-1b",
        "2": "us-west-1c"
      },
      "us-west-2": {
        "1": "us-west-2a",
        "2": "us-west-2b",
        "3": "us-west-2c",
        "4": "us-west-2d"
      }
    }
  },
  "Parameters": {
    "MasterInstanceType": {
      "Type": "String",
      "Description": "Select Instance type for OpenShift Master"
    },
    "InfrastructureInstanceType": {
      "Type": "String",
      "Description": "Select Instance type for OpenShift Infrastructure and Application Nodes"
    },
    "NodeInstanceType": {
      "Type": "String",
      "Description": "Select Instance type for OpenShift Infrastructure and Application Nodes"
    },
    "Ec2RootVolumeSize": {
      "Type": "String",
      "Description": "Select volume size for Root Volume"
    },
    "VPCId": {
      "Type": "String",
      "Description": "Select the VPC Id"
    },
    "SubnetIdAZ1": {
      "Type": "String",
      "Description": "Select a Subnet Id from AZ1"
    },
    "SubnetIdAZ2": {
      "Type": "String",
      "Description": "Select a Subnet Id from AZ2"
    },
    "SubnetIdAZ3": {
      "Type": "String",
      "Description": "Select a Subnet Id from AZ3"
    },
    "KeyName": {
      "Type": "String",
      "Description": "Select ssh key name"
    },
    "AMIId": {
      "Type": "String",
      "Description": "Select a RHEL AMI Id"
    },
    "outboundCIDRRangeIPv4": {
      "Type": "String",
    },
    "inboundCIDRRangeIPv4": {
      "Type": "String",
    }
  },
  "Resources": {
    "OpenShiftBastion": {
      "Type": "AWS::EC2::Instance",
      "Properties": {
        "AvailabilityZone": {
          "Fn::FindInMap": [
            "AWSRegion2AZ",
            {
              "Ref": "AWS::Region"
            },
            "1"
          ]
        },
        "ImageId": {
          "Ref": "AMIId"
        },
        "KeyName": {
          "Ref": "KeyName"
        },
        "InstanceType": {
          "Ref": "MasterInstanceType"
        },
        "NetworkInterfaces": [
          {
            "DeviceIndex": "0",
            "GroupSet": [
              {
                "Ref": "BastionSG"
              }
            ],
            "SubnetId": {
              "Ref": "SubnetIdAZ1"
            },
            "AssociatePublicIpAddress": "true"
          }
        ],
        "BlockDeviceMappings": [
          {
            "DeviceName": "/dev/sda1",
            "Ebs": {
              "DeleteOnTermination": "false",
              "VolumeSize": {
                "Ref": "Ec2RootVolumeSize"
              }
            }
          }
        ],
        "Tags": [
          {
            "Key": "Name",
            "Value": "Bastion Host"
          },
          {
            "Key": "keyname2",
            "Value": "value2"
          }
        ]
      }
    },
    "OpenShiftMaster1": {
      "Type": "AWS::EC2::Instance",
      "Properties": {
        "AvailabilityZone": {
          "Fn::FindInMap": [
            "AWSRegion2AZ",
            {
              "Ref": "AWS::Region"
            },
            "1"
          ]
        },
        "ImageId": {
          "Ref": "AMIId"
        },
        "KeyName": {
          "Ref": "KeyName"
        },
        "InstanceType": {
          "Ref": "MasterInstanceType"
        },
        "NetworkInterfaces": [
          {
            "DeviceIndex": "0",
            "GroupSet": [
              {
                "Ref": "MasterSG"
              },
              {
                "Ref": "NodeSG"
              }
            ],
            "SubnetId": {
              "Ref": "SubnetIdAZ1"
            }
          }
        ],
        "BlockDeviceMappings": [
          {
            "DeviceName": "/dev/sda1",
            "Ebs": {
              "DeleteOnTermination": "false",
              "VolumeSize": {
                "Ref": "Ec2RootVolumeSize"
              }
            }
          }
        ],
        "Tags": [
          {
            "Key": "Name",
            "Value": "OCPMaster1"
          },
          {
            "Key": "keyname2",
            "Value": "value2"
          }
        ]
      }
    },
    "OpenShiftMaster1LogVol": {
      "Type": "AWS::EC2::Volume",
      "Properties": {
        "VolumeType": "gp2",
        "Size": "30",
        "AvailabilityZone": {
          "Fn::FindInMap": [
            "AWSRegion2AZ",
            {
              "Ref": "AWS::Region"
            },
            "1"
          ]
        },
        "Tags": [
          {
            "Key": "Name",
            "Value": "OCPMaster1 Log Vol"
          }
        ]
      },
      "DeletionPolicy": "Retain"
    },
    "OpenShiftMaster1LogVolAtt": {
      "Type": "AWS::EC2::VolumeAttachment",
      "Properties": {
        "InstanceId": {
          "Ref": "OpenShiftMaster1"
        },
        "VolumeId": {
          "Ref": "OpenShiftMaster1LogVol"
        },
        "Device": "/dev/xvdba"
      }
    },
    "OpenShiftMaster1EtcdVol": {
      "Type": "AWS::EC2::Volume",
      "Properties": {
        "VolumeType": "gp2",
        "Size": "30",
        "AvailabilityZone": {
          "Fn::FindInMap": [
            "AWSRegion2AZ",
            {
              "Ref": "AWS::Region"
            },
            "1"
          ]
        },
        "Tags": [
          {
            "Key": "Name",
            "Value": "OCPMaster1 Ectd Vol"
          }
        ]
      },
      "DeletionPolicy": "Retain"
    },
    "OpenShiftMaster1EtcdVolAtt": {
      "Type": "AWS::EC2::VolumeAttachment",
      "Properties": {
        "InstanceId": {
          "Ref": "OpenShiftMaster1"
        },
        "VolumeId": {
          "Ref": "OpenShiftMaster1EtcdVol"
        },
        "Device": "/dev/xvdbd"
      }
    },
    "OpenShiftMaster1DockerVol": {
      "Type": "AWS::EC2::Volume",
      "Properties": {
        "VolumeType": "gp2",
        "Size": "30",
        "AvailabilityZone": {
          "Fn::FindInMap": [
            "AWSRegion2AZ",
            {
              "Ref": "AWS::Region"
            },
            "1"
          ]
        },
        "Tags": [
          {
            "Key": "Name",
            "Value": "OCPMaster1 Docker Vol"
          }
        ]
      },
      "DeletionPolicy": "Retain"
    },
    "OpenShiftMaster1DockerVolAtt": {
      "Type": "AWS::EC2::VolumeAttachment",
      "Properties": {
        "InstanceId": {
          "Ref": "OpenShiftMaster1"
        },
        "VolumeId": {
          "Ref": "OpenShiftMaster1DockerVol"
        },
        "Device": "/dev/xvdbc"
      }
    },
    "OpenShiftMaster1OCPLocalVol": {
      "Type": "AWS::EC2::Volume",
      "Properties": {
        "VolumeType": "gp2",
        "Size": "40",
        "AvailabilityZone": {
          "Fn::FindInMap": [
            "AWSRegion2AZ",
            {
              "Ref": "AWS::Region"
            },
            "1"
          ]
        },
        "Tags": [
          {
            "Key": "Name",
            "Value": "OCPMaster1 OpenShift Local Vol"
          }
        ]
      },
      "DeletionPolicy": "Retain"
    },
    "OpenShiftMaster1OCPLocalVolAtt": {
      "Type": "AWS::EC2::VolumeAttachment",
      "Properties": {
        "InstanceId": {
          "Ref": "OpenShiftMaster1"
        },
        "VolumeId": {
          "Ref": "OpenShiftMaster1OCPLocalVol"
        },
        "Device": "/dev/xvdbb"
      }
    },
    "OpenShiftMaster2": {
      "Type": "AWS::EC2::Instance",
      "Properties": {
        "AvailabilityZone": {
          "Fn::FindInMap": [
            "AWSRegion2AZ",
            {
              "Ref": "AWS::Region"
            },
            "2"
          ]
        },
        "ImageId": {
          "Ref": "AMIId"
        },
        "KeyName": {
          "Ref": "KeyName"
        },
        "InstanceType": {
          "Ref": "MasterInstanceType"
        },
        "NetworkInterfaces": [
          {
            "DeviceIndex": "0",
            "GroupSet": [
              {
                "Ref": "MasterSG"
              },
              {
                "Ref": "NodeSG"
              }
            ],
            "SubnetId": {
              "Ref": "SubnetIdAZ2"
            }
          }
        ],
        "BlockDeviceMappings": [
          {
            "DeviceName": "/dev/sda1",
            "Ebs": {
              "DeleteOnTermination": "false",
              "VolumeSize": {
                "Ref": "Ec2RootVolumeSize"
              }
            }
          }
        ],
        "Tags": [
          {
            "Key": "Name",
            "Value": "OCPMaster2"
          },
          {
            "Key": "keyname2",
            "Value": "value2"
          }
        ]
      }
    },
    "OpenShiftMaster2LogVol": {
      "Type": "AWS::EC2::Volume",
      "Properties": {
        "VolumeType": "gp2",
        "Size": "30",
        "AvailabilityZone": {
          "Fn::FindInMap": [
            "AWSRegion2AZ",
            {
              "Ref": "AWS::Region"
            },
            "2"
          ]
        },
        "Tags": [
          {
            "Key": "Name",
            "Value": "OCPMaster2 Log Vol"
          }
        ]
      },
      "DeletionPolicy": "Retain"
    },
    "OpenShiftMaster2LogVolAtt": {
      "Type": "AWS::EC2::VolumeAttachment",
      "Properties": {
        "InstanceId": {
          "Ref": "OpenShiftMaster2"
        },
        "VolumeId": {
          "Ref": "OpenShiftMaster2LogVol"
        },
        "Device": "/dev/xvdba"
      }
    },
    "OpenShiftMaster2EtcdVol": {
      "Type": "AWS::EC2::Volume",
      "Properties": {
        "VolumeType": "gp2",
        "Size": "30",
        "AvailabilityZone": {
          "Fn::FindInMap": [
            "AWSRegion2AZ",
            {
              "Ref": "AWS::Region"
            },
            "2"
          ]
        },
        "Tags": [
          {
            "Key": "Name",
            "Value": "OCPMaster2 Ectd Vol"
          }
        ]
      },
      "DeletionPolicy": "Retain"
    },
    "OpenShiftMaster2EtcdVolAtt": {
      "Type": "AWS::EC2::VolumeAttachment",
      "Properties": {
        "InstanceId": {
          "Ref": "OpenShiftMaster2"
        },
        "VolumeId": {
          "Ref": "OpenShiftMaster2EtcdVol"
        },
        "Device": "/dev/xvdbd"
      }
    },
    "OpenShiftMaster2DockerVol": {
      "Type": "AWS::EC2::Volume",
      "Properties": {
        "VolumeType": "gp2",
        "Size": "30",
        "AvailabilityZone": {
          "Fn::FindInMap": [
            "AWSRegion2AZ",
            {
              "Ref": "AWS::Region"
            },
            "2"
          ]
        },
        "Tags": [
          {
            "Key": "Name",
            "Value": "OCPMaster2 Docker Vol"
          }
        ]
      },
      "DeletionPolicy": "Retain"
    },
    "OpenShiftMaster2DockerVolAtt": {
      "Type": "AWS::EC2::VolumeAttachment",
      "Properties": {
        "InstanceId": {
          "Ref": "OpenShiftMaster2"
        },
        "VolumeId": {
          "Ref": "OpenShiftMaster2DockerVol"
        },
        "Device": "/dev/xvdbc"
      }
    },
    "OpenShiftMaster2OCPLocalVol": {
      "Type": "AWS::EC2::Volume",
      "Properties": {
        "VolumeType": "gp2",
        "Size": "40",
        "AvailabilityZone": {
          "Fn::FindInMap": [
            "AWSRegion2AZ",
            {
              "Ref": "AWS::Region"
            },
            "2"
          ]
        },
        "Tags": [
          {
            "Key": "Name",
            "Value": "OCPMaster2 OpenShift Local Vol"
          }
        ]
      },
      "DeletionPolicy": "Retain"
    },
    "OpenShiftMaster2OCPLocalVolAtt": {
      "Type": "AWS::EC2::VolumeAttachment",
      "Properties": {
        "InstanceId": {
          "Ref": "OpenShiftMaster2"
        },
        "VolumeId": {
          "Ref": "OpenShiftMaster2OCPLocalVol"
        },
        "Device": "/dev/xvdbb"
      }
    },
    "OpenShiftMaster3": {
      "Type": "AWS::EC2::Instance",
      "Properties": {
        "AvailabilityZone": {
          "Fn::FindInMap": [
            "AWSRegion2AZ",
            {
              "Ref": "AWS::Region"
            },
            "3"
          ]
        },
        "ImageId": {
          "Ref": "AMIId"
        },
        "KeyName": {
          "Ref": "KeyName"
        },
        "InstanceType": {
          "Ref": "MasterInstanceType"
        },
        "NetworkInterfaces": [
          {
            "DeviceIndex": "0",
            "GroupSet": [
              {
                "Ref": "MasterSG"
              },
              {
                "Ref": "NodeSG"
              }
            ],
            "SubnetId": {
              "Ref": "SubnetIdAZ3"
            }
          }
        ],
        "BlockDeviceMappings": [
          {
            "DeviceName": "/dev/sda1",
            "Ebs": {
              "DeleteOnTermination": "false",
              "VolumeSize": {
                "Ref": "Ec2RootVolumeSize"
              }
            }
          }
        ],
        "Tags": [
          {
            "Key": "Name",
            "Value": "OCPMaster3"
          },
          {
            "Key": "keyname2",
            "Value": "value2"
          }
        ]
      }
    },
    "OpenShiftMaster3LogVol": {
      "Type": "AWS::EC2::Volume",
      "Properties": {
        "VolumeType": "gp2",
        "Size": "30",
        "AvailabilityZone": {
          "Fn::FindInMap": [
            "AWSRegion2AZ",
            {
              "Ref": "AWS::Region"
            },
            "3"
          ]
        },
        "Tags": [
          {
            "Key": "Name",
            "Value": "OCPMaster3 Log Vol"
          }
        ]
      },
      "DeletionPolicy": "Retain"
    },
    "OpenShiftMaster3LogVolAtt": {
      "Type": "AWS::EC2::VolumeAttachment",
      "Properties": {
        "InstanceId": {
          "Ref": "OpenShiftMaster3"
        },
        "VolumeId": {
          "Ref": "OpenShiftMaster3LogVol"
        },
        "Device": "/dev/xvdba"
      }
    },
    "OpenShiftMaster3EtcdVol": {
      "Type": "AWS::EC2::Volume",
      "Properties": {
        "VolumeType": "gp2",
        "Size": "30",
        "AvailabilityZone": {
          "Fn::FindInMap": [
            "AWSRegion2AZ",
            {
              "Ref": "AWS::Region"
            },
            "3"
          ]
        },
        "Tags": [
          {
            "Key": "Name",
            "Value": "OCPMaster3 Ectd Vol"
          }
        ]
      },
      "DeletionPolicy": "Retain"
    },
    "OpenShiftMaster3EtcdVolAtt": {
      "Type": "AWS::EC2::VolumeAttachment",
      "Properties": {
        "InstanceId": {
          "Ref": "OpenShiftMaster3"
        },
        "VolumeId": {
          "Ref": "OpenShiftMaster3EtcdVol"
        },
        "Device": "/dev/xvdbd"
      }
    },
    "OpenShiftMaster3DockerVol": {
      "Type": "AWS::EC2::Volume",
      "Properties": {
        "VolumeType": "gp2",
        "Size": "30",
        "AvailabilityZone": {
          "Fn::FindInMap": [
            "AWSRegion2AZ",
            {
              "Ref": "AWS::Region"
            },
            "3"
          ]
        },
        "Tags": [
          {
            "Key": "Name",
            "Value": "OCPMaster3 Docker Vol"
          }
        ]
      },
      "DeletionPolicy": "Retain"
    },
    "OpenShiftMaster3DockerVolAtt": {
      "Type": "AWS::EC2::VolumeAttachment",
      "Properties": {
        "InstanceId": {
          "Ref": "OpenShiftMaster3"
        },
        "VolumeId": {
          "Ref": "OpenShiftMaster3DockerVol"
        },
        "Device": "/dev/xvdbc"
      }
    },
    "OpenShiftMaster3OCPLocalVol": {
      "Type": "AWS::EC2::Volume",
      "Properties": {
        "VolumeType": "gp2",
        "Size": "40",
        "AvailabilityZone": {
          "Fn::FindInMap": [
            "AWSRegion2AZ",
            {
              "Ref": "AWS::Region"
            },
            "3"
          ]
        },
        "Tags": [
          {
            "Key": "Name",
            "Value": "OCPMaster3 OpenShift Local Vol"
          }
        ]
      },
      "DeletionPolicy": "Retain"
    },
    "OpenShiftMaster3OCPLocalVolAtt": {
      "Type": "AWS::EC2::VolumeAttachment",
      "Properties": {
        "InstanceId": {
          "Ref": "OpenShiftMaster3"
        },
        "VolumeId": {
          "Ref": "OpenShiftMaster3OCPLocalVol"
        },
        "Device": "/dev/xvdbb"
      }
    },
    "OpenShiftInfrastructure1": {
      "Type": "AWS::EC2::Instance",
      "Properties": {
        "AvailabilityZone": {
          "Fn::FindInMap": [
            "AWSRegion2AZ",
            {
              "Ref": "AWS::Region"
            },
            "1"
          ]
        },
        "ImageId": {
          "Ref": "AMIId"
        },
        "KeyName": {
          "Ref": "KeyName"
        },
        "InstanceType": {
          "Ref": "InfrastructureInstanceType"
        },
        "NetworkInterfaces": [
          {
            "DeviceIndex": "0",
            "GroupSet": [
              {
                "Ref": "InfrastructureSG"
              },
              {
                "Ref": "NodeSG"
              }
            ],
            "SubnetId": {
              "Ref": "SubnetIdAZ1"
            }
          }
        ],
        "BlockDeviceMappings": [
          {
            "DeviceName": "/dev/sda1",
            "Ebs": {
              "DeleteOnTermination": "false",
              "VolumeSize": {
                "Ref": "Ec2RootVolumeSize"
              }
            }
          }
        ],
        "Tags": [
          {
            "Key": "Name",
            "Value": "OCPInfrastructure1"
          },
          {
            "Key": "keyname2",
            "Value": "value2"
          }
        ]
      }
    },
    "OpenShiftInfrastructure1LogVol": {
      "Type": "AWS::EC2::Volume",
      "Properties": {
        "VolumeType": "gp2",
        "Size": "30",
        "AvailabilityZone": {
          "Fn::FindInMap": [
            "AWSRegion2AZ",
            {
              "Ref": "AWS::Region"
            },
            "1"
          ]
        },
        "Tags": [
          {
            "Key": "Name",
            "Value": "OCPInfrastructure1 Log Vol"
          }
        ]
      },
      "DeletionPolicy": "Retain"
    },
    "OpenShiftInfrastructure1LogVolAtt": {
      "Type": "AWS::EC2::VolumeAttachment",
      "Properties": {
        "InstanceId": {
          "Ref": "OpenShiftInfrastructure1"
        },
        "VolumeId": {
          "Ref": "OpenShiftInfrastructure1LogVol"
        },
        "Device": "/dev/xvdba"
      }
    },
    "OpenShiftInfrastructure1DockerVol": {
      "Type": "AWS::EC2::Volume",
      "Properties": {
        "VolumeType": "gp2",
        "Size": "30",
        "AvailabilityZone": {
          "Fn::FindInMap": [
            "AWSRegion2AZ",
            {
              "Ref": "AWS::Region"
            },
            "1"
          ]
        },
        "Tags": [
          {
            "Key": "Name",
            "Value": "OCPInfrastructure1 Docker Vol"
          }
        ]
      },
      "DeletionPolicy": "Retain"
    },
    "OpenShiftInfrastructure1DockerVolAtt": {
      "Type": "AWS::EC2::VolumeAttachment",
      "Properties": {
        "InstanceId": {
          "Ref": "OpenShiftInfrastructure1"
        },
        "VolumeId": {
          "Ref": "OpenShiftInfrastructure1DockerVol"
        },
        "Device": "/dev/xvdbc"
      }
    },
    "OpenShiftInfrastructure1OCPLocalVol": {
      "Type": "AWS::EC2::Volume",
      "Properties": {
        "VolumeType": "gp2",
        "Size": "40",
        "AvailabilityZone": {
          "Fn::FindInMap": [
            "AWSRegion2AZ",
            {
              "Ref": "AWS::Region"
            },
            "1"
          ]
        },
        "Tags": [
          {
            "Key": "Name",
            "Value": "OCPInfrastructure1 OpenShift Local Vol"
          }
        ]
      },
      "DeletionPolicy": "Retain"
    },
    "OpenShiftInfrastructure1OCPLocalVolAtt": {
      "Type": "AWS::EC2::VolumeAttachment",
      "Properties": {
        "InstanceId": {
          "Ref": "OpenShiftInfrastructure1"
        },
        "VolumeId": {
          "Ref": "OpenShiftInfrastructure1OCPLocalVol"
        },
        "Device": "/dev/xvdbb"
      }
    },
    "OpenShiftInfrastructure2": {
      "Type": "AWS::EC2::Instance",
      "Properties": {
        "AvailabilityZone": {
          "Fn::FindInMap": [
            "AWSRegion2AZ",
            {
              "Ref": "AWS::Region"
            },
            "2"
          ]
        },
        "ImageId": {
          "Ref": "AMIId"
        },
        "KeyName": {
          "Ref": "KeyName"
        },
        "InstanceType": {
          "Ref": "InfrastructureInstanceType"
        },
        "NetworkInterfaces": [
          {
            "DeviceIndex": "0",
            "GroupSet": [
              {
                "Ref": "InfrastructureSG"
              },
              {
                "Ref": "NodeSG"
              }
            ],
            "SubnetId": {
              "Ref": "SubnetIdAZ2"
            }
          }
        ],
        "BlockDeviceMappings": [
          {
            "DeviceName": "/dev/sda1",
            "Ebs": {
              "DeleteOnTermination": "false",
              "VolumeSize": {
                "Ref": "Ec2RootVolumeSize"
              }
            }
          }
        ],
        "Tags": [
          {
            "Key": "Name",
            "Value": "OCPInfrastructure2"
          },
          {
            "Key": "keyname2",
            "Value": "value2"
          }
        ]
      }
    },
    "OpenShiftInfrastructure2LogVol": {
      "Type": "AWS::EC2::Volume",
      "Properties": {
        "VolumeType": "gp2",
        "Size": "30",
        "AvailabilityZone": {
          "Fn::FindInMap": [
            "AWSRegion2AZ",
            {
              "Ref": "AWS::Region"
            },
            "2"
          ]
        },
        "Tags": [
          {
            "Key": "Name",
            "Value": "OCPInfrastructure2 Log Vol"
          }
        ]
      },
      "DeletionPolicy": "Retain"
    },
    "OpenShiftInfrastructure2LogVolAtt": {
      "Type": "AWS::EC2::VolumeAttachment",
      "Properties": {
        "InstanceId": {
          "Ref": "OpenShiftInfrastructure2"
        },
        "VolumeId": {
          "Ref": "OpenShiftInfrastructure2LogVol"
        },
        "Device": "/dev/xvdba"
      }
    },
    "OpenShiftInfrastructure2DockerVol": {
      "Type": "AWS::EC2::Volume",
      "Properties": {
        "VolumeType": "gp2",
        "Size": "30",
        "AvailabilityZone": {
          "Fn::FindInMap": [
            "AWSRegion2AZ",
            {
              "Ref": "AWS::Region"
            },
            "2"
          ]
        },
        "Tags": [
          {
            "Key": "Name",
            "Value": "OCPInfrastructure2 Docker Vol"
          }
        ]
      },
      "DeletionPolicy": "Retain"
    },
    "OpenShiftInfrastructure2DockerVolAtt": {
      "Type": "AWS::EC2::VolumeAttachment",
      "Properties": {
        "InstanceId": {
          "Ref": "OpenShiftInfrastructure2"
        },
        "VolumeId": {
          "Ref": "OpenShiftInfrastructure2DockerVol"
        },
        "Device": "/dev/xvdbc"
      }
    },
    "OpenShiftInfrastructure2OCPLocalVol": {
      "Type": "AWS::EC2::Volume",
      "Properties": {
        "VolumeType": "gp2",
        "Size": "40",
        "AvailabilityZone": {
          "Fn::FindInMap": [
            "AWSRegion2AZ",
            {
              "Ref": "AWS::Region"
            },
            "2"
          ]
        },
        "Tags": [
          {
            "Key": "Name",
            "Value": "OCPInfrastructure2 OpenShift Local Vol"
          }
        ]
      },
      "DeletionPolicy": "Retain"
    },
    "OpenShiftInfrastructure2OCPLocalVolAtt": {
      "Type": "AWS::EC2::VolumeAttachment",
      "Properties": {
        "InstanceId": {
          "Ref": "OpenShiftInfrastructure2"
        },
        "VolumeId": {
          "Ref": "OpenShiftInfrastructure2OCPLocalVol"
        },
        "Device": "/dev/xvdbb"
      }
    },
    "OpenShiftInfrastructure3": {
      "Type": "AWS::EC2::Instance",
      "Properties": {
        "AvailabilityZone": {
          "Fn::FindInMap": [
            "AWSRegion2AZ",
            {
              "Ref": "AWS::Region"
            },
            "3"
          ]
        },
        "ImageId": {
          "Ref": "AMIId"
        },
        "KeyName": {
          "Ref": "KeyName"
        },
        "InstanceType": {
          "Ref": "InfrastructureInstanceType"
        },
        "NetworkInterfaces": [
          {
            "DeviceIndex": "0",
            "GroupSet": [
              {
                "Ref": "InfrastructureSG"
              },
              {
                "Ref": "NodeSG"
              }
            ],
            "SubnetId": {
              "Ref": "SubnetIdAZ3"
            }
          }
        ],
        "BlockDeviceMappings": [
          {
            "DeviceName": "/dev/sda1",
            "Ebs": {
              "DeleteOnTermination": "false",
              "VolumeSize": {
                "Ref": "Ec2RootVolumeSize"
              }
            }
          }
        ],
        "Tags": [
          {
            "Key": "Name",
            "Value": "OCPInfrastructure3"
          },
          {
            "Key": "keyname2",
            "Value": "value2"
          }
        ]
      }
    },
    "OpenShiftInfrastructure3LogVol": {
      "Type": "AWS::EC2::Volume",
      "Properties": {
        "VolumeType": "gp2",
        "Size": "30",
        "AvailabilityZone": {
          "Fn::FindInMap": [
            "AWSRegion2AZ",
            {
              "Ref": "AWS::Region"
            },
            "3"
          ]
        },
        "Tags": [
          {
            "Key": "Name",
            "Value": "OCPInfrastructure3 Log Vol"
          }
        ]
      },
      "DeletionPolicy": "Retain"
    },
    "OpenShiftInfrastructure3LogVolAtt": {
      "Type": "AWS::EC2::VolumeAttachment",
      "Properties": {
        "InstanceId": {
          "Ref": "OpenShiftInfrastructure3"
        },
        "VolumeId": {
          "Ref": "OpenShiftInfrastructure3LogVol"
        },
        "Device": "/dev/xvdba"
      }
    },
    "OpenShiftInfrastructure3DockerVol": {
      "Type": "AWS::EC2::Volume",
      "Properties": {
        "VolumeType": "gp2",
        "Size": "30",
        "AvailabilityZone": {
          "Fn::FindInMap": [
            "AWSRegion2AZ",
            {
              "Ref": "AWS::Region"
            },
            "3"
          ]
        },
        "Tags": [
          {
            "Key": "Name",
            "Value": "OCPInfrastructure3 Docker Vol"
          }
        ]
      },
      "DeletionPolicy": "Retain"
    },
    "OpenShiftInfrastructure3DockerVolAtt": {
      "Type": "AWS::EC2::VolumeAttachment",
      "Properties": {
        "InstanceId": {
          "Ref": "OpenShiftInfrastructure3"
        },
        "VolumeId": {
          "Ref": "OpenShiftInfrastructure3DockerVol"
        },
        "Device": "/dev/xvdbc"
      }
    },
    "OpenShiftInfrastructure3OCPLocalVol": {
      "Type": "AWS::EC2::Volume",
      "Properties": {
        "VolumeType": "gp2",
        "Size": "40",
        "AvailabilityZone": {
          "Fn::FindInMap": [
            "AWSRegion2AZ",
            {
              "Ref": "AWS::Region"
            },
            "3"
          ]
        },
        "Tags": [
          {
            "Key": "Name",
            "Value": "OCPInfrastructure3 OpenShift Local Vol"
          }
        ]
      },
      "DeletionPolicy": "Retain"
    },
    "OpenShiftInfrastructure3OCPLocalVolAtt": {
      "Type": "AWS::EC2::VolumeAttachment",
      "Properties": {
        "InstanceId": {
          "Ref": "OpenShiftInfrastructure3"
        },
        "VolumeId": {
          "Ref": "OpenShiftInfrastructure3OCPLocalVol"
        },
        "Device": "/dev/xvdbb"
      }
    },
    "OpenShiftNode1": {
      "Type": "AWS::EC2::Instance",
      "Properties": {
        "AvailabilityZone": {
          "Fn::FindInMap": [
            "AWSRegion2AZ",
            {
              "Ref": "AWS::Region"
            },
            "1"
          ]
        },
        "ImageId": {
          "Ref": "AMIId"
        },
        "KeyName": {
          "Ref": "KeyName"
        },
        "InstanceType": {
          "Ref": "NodeInstanceType"
        },
        "NetworkInterfaces": [
          {
            "DeviceIndex": "0",
            "GroupSet": [
              {
                "Ref": "NodeSG"
              }
            ],
            "SubnetId": {
              "Ref": "SubnetIdAZ1"
            }
          }
        ],
        "BlockDeviceMappings": [
          {
            "DeviceName": "/dev/sda1",
            "Ebs": {
              "DeleteOnTermination": "false",
              "VolumeSize": {
                "Ref": "Ec2RootVolumeSize"
              }
            }
          }
        ],
        "Tags": [
          {
            "Key": "Name",
            "Value": "OCPNode1"
          },
          {
            "Key": "keyname2",
            "Value": "value2"
          }
        ]
      }
    },
    "OpenShiftNode1LogVol": {
      "Type": "AWS::EC2::Volume",
      "Properties": {
        "VolumeType": "gp2",
        "Size": "30",
        "AvailabilityZone": {
          "Fn::FindInMap": [
            "AWSRegion2AZ",
            {
              "Ref": "AWS::Region"
            },
            "1"
          ]
        },
        "Tags": [
          {
            "Key": "Name",
            "Value": "OCPNode1 Log Vol"
          }
        ]
      },
      "DeletionPolicy": "Retain"
    },
    "OpenShiftNode1LogVolAtt": {
      "Type": "AWS::EC2::VolumeAttachment",
      "Properties": {
        "InstanceId": {
          "Ref": "OpenShiftNode1"
        },
        "VolumeId": {
          "Ref": "OpenShiftNode1LogVol"
        },
        "Device": "/dev/xvdba"
      }
    },
    "OpenShiftNode1DockerVol": {
      "Type": "AWS::EC2::Volume",
      "Properties": {
        "VolumeType": "gp2",
        "Size": "30",
        "AvailabilityZone": {
          "Fn::FindInMap": [
            "AWSRegion2AZ",
            {
              "Ref": "AWS::Region"
            },
            "1"
          ]
        },
        "Tags": [
          {
            "Key": "Name",
            "Value": "OCPNode1 Docker Vol"
          }
        ]
      },
      "DeletionPolicy": "Retain"
    },
    "OpenShiftNode1DockerVolAtt": {
      "Type": "AWS::EC2::VolumeAttachment",
      "Properties": {
        "InstanceId": {
          "Ref": "OpenShiftNode1"
        },
        "VolumeId": {
          "Ref": "OpenShiftNode1DockerVol"
        },
        "Device": "/dev/xvdbc"
      }
    },
    "OpenShiftNode1OCPLocalVol": {
      "Type": "AWS::EC2::Volume",
      "Properties": {
        "VolumeType": "gp2",
        "Size": "40",
        "AvailabilityZone": {
          "Fn::FindInMap": [
            "AWSRegion2AZ",
            {
              "Ref": "AWS::Region"
            },
            "1"
          ]
        },
        "Tags": [
          {
            "Key": "Name",
            "Value": "OCPNode1 OpenShift Local Vol"
          }
        ]
      },
      "DeletionPolicy": "Retain"
    },
    "OpenShiftNode1OCPLocalVolAtt": {
      "Type": "AWS::EC2::VolumeAttachment",
      "Properties": {
        "InstanceId": {
          "Ref": "OpenShiftNode1"
        },
        "VolumeId": {
          "Ref": "OpenShiftNode1OCPLocalVol"
        },
        "Device": "/dev/xvdbb"
      }
    },
    "OpenShiftNode2": {
      "Type": "AWS::EC2::Instance",
      "Properties": {
        "AvailabilityZone": {
          "Fn::FindInMap": [
            "AWSRegion2AZ",
            {
              "Ref": "AWS::Region"
            },
            "2"
          ]
        },
        "ImageId": {
          "Ref": "AMIId"
        },
        "KeyName": {
          "Ref": "KeyName"
        },
        "InstanceType": {
          "Ref": "NodeInstanceType"
        },
        "NetworkInterfaces": [
          {
            "DeviceIndex": "0",
            "GroupSet": [
              {
                "Ref": "NodeSG"
              }
            ],
            "SubnetId": {
              "Ref": "SubnetIdAZ2"
            }
          }
        ],
        "BlockDeviceMappings": [
          {
            "DeviceName": "/dev/sda1",
            "Ebs": {
              "DeleteOnTermination": "false",
              "VolumeSize": {
                "Ref": "Ec2RootVolumeSize"
              }
            }
          }
        ],
        "Tags": [
          {
            "Key": "Name",
            "Value": "OCPNode2"
          },
          {
            "Key": "keyname2",
            "Value": "value2"
          }
        ]
      }
    },
    "OpenShiftNode2LogVol": {
      "Type": "AWS::EC2::Volume",
      "Properties": {
        "VolumeType": "gp2",
        "Size": "30",
        "AvailabilityZone": {
          "Fn::FindInMap": [
            "AWSRegion2AZ",
            {
              "Ref": "AWS::Region"
            },
            "2"
          ]
        },
        "Tags": [
          {
            "Key": "Name",
            "Value": "OCPNode2 Log Vol"
          }
        ]
      },
      "DeletionPolicy": "Retain"
    },
    "OpenShiftNode2LogVolAtt": {
      "Type": "AWS::EC2::VolumeAttachment",
      "Properties": {
        "InstanceId": {
          "Ref": "OpenShiftNode2"
        },
        "VolumeId": {
          "Ref": "OpenShiftNode2LogVol"
        },
        "Device": "/dev/xvdba"
      }
    },
    "OpenShiftNode2DockerVol": {
      "Type": "AWS::EC2::Volume",
      "Properties": {
        "VolumeType": "gp2",
        "Size": "30",
        "AvailabilityZone": {
          "Fn::FindInMap": [
            "AWSRegion2AZ",
            {
              "Ref": "AWS::Region"
            },
            "2"
          ]
        },
        "Tags": [
          {
            "Key": "Name",
            "Value": "OCPNode2 Docker Vol"
          }
        ]
      },
      "DeletionPolicy": "Retain"
    },
    "OpenShiftNode2DockerVolAtt": {
      "Type": "AWS::EC2::VolumeAttachment",
      "Properties": {
        "InstanceId": {
          "Ref": "OpenShiftNode2"
        },
        "VolumeId": {
          "Ref": "OpenShiftNode2DockerVol"
        },
        "Device": "/dev/xvdbc"
      }
    },
    "OpenShiftNode2OCPLocalVol": {
      "Type": "AWS::EC2::Volume",
      "Properties": {
        "VolumeType": "gp2",
        "Size": "40",
        "AvailabilityZone": {
          "Fn::FindInMap": [
            "AWSRegion2AZ",
            {
              "Ref": "AWS::Region"
            },
            "2"
          ]
        },
        "Tags": [
          {
            "Key": "Name",
            "Value": "OCPNode2 OpenShift Local Vol"
          }
        ]
      },
      "DeletionPolicy": "Retain"
    },
    "OpenShiftNode2OCPLocalVolAtt": {
      "Type": "AWS::EC2::VolumeAttachment",
      "Properties": {
        "InstanceId": {
          "Ref": "OpenShiftNode2"
        },
        "VolumeId": {
          "Ref": "OpenShiftNode2OCPLocalVol"
        },
        "Device": "/dev/xvdbb"
      }
    },
    "OpenShiftNode3": {
      "Type": "AWS::EC2::Instance",
      "Properties": {
        "AvailabilityZone": {
          "Fn::FindInMap": [
            "AWSRegion2AZ",
            {
              "Ref": "AWS::Region"
            },
            "3"
          ]
        },
        "ImageId": {
          "Ref": "AMIId"
        },
        "KeyName": {
          "Ref": "KeyName"
        },
        "InstanceType": {
          "Ref": "NodeInstanceType"
        },
        "NetworkInterfaces": [
          {
            "DeviceIndex": "0",
            "GroupSet": [
              {
                "Ref": "NodeSG"
              }
            ],
            "SubnetId": {
              "Ref": "SubnetIdAZ3"
            }
          }
        ],
        "BlockDeviceMappings": [
          {
            "DeviceName": "/dev/sda1",
            "Ebs": {
              "DeleteOnTermination": "false",
              "VolumeSize": {
                "Ref": "Ec2RootVolumeSize"
              }
            }
          }
        ],
        "Tags": [
          {
            "Key": "Name",
            "Value": "OCPNode3"
          },
          {
            "Key": "keyname2",
            "Value": "value2"
          }
        ]
      }
    },
    "OpenShiftNode3LogVol": {
      "Type": "AWS::EC2::Volume",
      "Properties": {
        "VolumeType": "gp2",
        "Size": "30",
        "AvailabilityZone": {
          "Fn::FindInMap": [
            "AWSRegion2AZ",
            {
              "Ref": "AWS::Region"
            },
            "3"
          ]
        },
        "Tags": [
          {
            "Key": "Name",
            "Value": "OCPNode3 Log Vol"
          }
        ]
      },
      "DeletionPolicy": "Retain"
    },
    "OpenShiftNode3LogVolAtt": {
      "Type": "AWS::EC2::VolumeAttachment",
      "Properties": {
        "InstanceId": {
          "Ref": "OpenShiftNode3"
        },
        "VolumeId": {
          "Ref": "OpenShiftNode3LogVol"
        },
        "Device": "/dev/xvdba"
      }
    },
    "OpenShiftNode3DockerVol": {
      "Type": "AWS::EC2::Volume",
      "Properties": {
        "VolumeType": "gp2",
        "Size": "30",
        "AvailabilityZone": {
          "Fn::FindInMap": [
            "AWSRegion2AZ",
            {
              "Ref": "AWS::Region"
            },
            "3"
          ]
        },
        "Tags": [
          {
            "Key": "Name",
            "Value": "OCPNode3 Docker Vol"
          }
        ]
      },
      "DeletionPolicy": "Retain"
    },
    "OpenShiftNode3DockerVolAtt": {
      "Type": "AWS::EC2::VolumeAttachment",
      "Properties": {
        "InstanceId": {
          "Ref": "OpenShiftNode3"
        },
        "VolumeId": {
          "Ref": "OpenShiftNode3DockerVol"
        },
        "Device": "/dev/xvdbc"
      }
    },
    "OpenShiftNode3OCPLocalVol": {
      "Type": "AWS::EC2::Volume",
      "Properties": {
        "VolumeType": "gp2",
        "Size": "40",
        "AvailabilityZone": {
          "Fn::FindInMap": [
            "AWSRegion2AZ",
            {
              "Ref": "AWS::Region"
            },
            "3"
          ]
        },
        "Tags": [
          {
            "Key": "Name",
            "Value": "OCPNode3 OpenShift Local Vol"
          }
        ]
      },
      "DeletionPolicy": "Retain"
    },
    "OpenShiftNode3OCPLocalVolAtt": {
      "Type": "AWS::EC2::VolumeAttachment",
      "Properties": {
        "InstanceId": {
          "Ref": "OpenShiftNode3"
        },
        "VolumeId": {
          "Ref": "OpenShiftNode3OCPLocalVol"
        },
        "Device": "/dev/xvdbb"
      }
    },
    "MasterSG": {
      "Type": "AWS::EC2::SecurityGroup",
      "Properties": {
        "VpcId": {
          "Ref": "VPCId"
        },
        "GroupDescription": "OpenShift Master Security Group"
      }
    },
    "NodeSG": {
      "Type": "AWS::EC2::SecurityGroup",
      "Properties": {
        "VpcId": {
          "Ref": "VPCId"
        },
        "GroupDescription": "OpenShift Node Security Group"
      }
    },
    "InfrastructureSG": {
      "Type": "AWS::EC2::SecurityGroup",
      "Properties": {
        "VpcId": {
          "Ref": "VPCId"
        },
        "GroupDescription": "OpenShift Infrastructure Security Group"
      }
    },
    "BastionSG": {
      "Type": "AWS::EC2::SecurityGroup",
      "Properties": {
        "VpcId": {
          "Ref": "VPCId"
        },
        "GroupDescription": "Bastion Security Group"
      }
    },
    "OutboundRuleMasterSG": {
      "Type": "AWS::EC2::SecurityGroupEgress",
      "Properties": {
        "IpProtocol": "tcp",
        "ToPort": 65535,
        "FromPort": 0,
        "CidrIp": {
          "Ref": "outboundCIDRRangeIPv4"
        },
        "GroupId": {
          "Fn::GetAtt": [
            "MasterSG",
            "GroupId"
          ]
        }
      }
    },
    "OutboundRuleNodeSG": {
      "Type": "AWS::EC2::SecurityGroupEgress",
      "Properties": {
        "IpProtocol": "tcp",
        "ToPort": 65535,
        "FromPort": 0,
        "CidrIp": {
          "Ref": "outboundCIDRRangeIPv4"
        },
        "GroupId": {
          "Fn::GetAtt": [
            "NodeSG",
            "GroupId"
          ]
        }
      }
    },
    "OutboundRuleInfraSG": {
      "Type": "AWS::EC2::SecurityGroupEgress",
      "Properties": {
        "IpProtocol": "tcp",
        "ToPort": 65535,
        "FromPort": 0,
        "CidrIp": {
          "Ref": "outboundCIDRRangeIPv4"
        },
        "GroupId": {
          "Fn::GetAtt": [
            "InfrastructureSG",
            "GroupId"
          ]
        }
      }
    },
    "OutboundRuleBastionSG": {
      "Type": "AWS::EC2::SecurityGroupEgress",
      "Properties": {
        "IpProtocol": "tcp",
        "ToPort": 65535,
        "FromPort": 0,
        "CidrIp": {
          "Ref": "outboundCIDRRangeIPv4"
        },
        "GroupId": {
          "Fn::GetAtt": [
            "BastionSG",
            "GroupId"
          ]
        }
      }
    },
    "InboundRuleForMasterAPIAndConsole": {
      "Type": "AWS::EC2::SecurityGroupIngress",
      "Properties": {
        "IpProtocol": "tcp",
        "ToPort": 443,
        "FromPort": 443,
        "CidrIp": {
          "Ref": "inboundCIDRRangeIPv4"
        },
        "GroupId": {
          "Fn::GetAtt": [
            "MasterSG",
            "GroupId"
          ]
        }
      }
    },
    "InboundRuleForNodesInternalNSTCP53": {
      "Type": "AWS::EC2::SecurityGroupIngress",
      "Properties": {
        "IpProtocol": "tcp",
        "ToPort": 53,
        "FromPort": 53,
        "SourceSecurityGroupId": {
          "Fn::GetAtt": [
            "NodeSG",
            "GroupId"
          ]
        },
        "GroupId": {
          "Fn::GetAtt": [
            "MasterSG",
            "GroupId"
          ]
        }
      }
    },
    "InboundRuleForNodesInternalNSUDP53": {
      "Type": "AWS::EC2::SecurityGroupIngress",
      "Properties": {
        "IpProtocol": "udp",
        "ToPort": 53,
        "FromPort": 53,
        "SourceSecurityGroupId": {
          "Fn::GetAtt": [
            "NodeSG",
            "GroupId"
          ]
        },
        "GroupId": {
          "Fn::GetAtt": [
            "MasterSG",
            "GroupId"
          ]
        }
      }
    },
    "InboundRuleForNodesInternalNSTCP8053": {
      "Type": "AWS::EC2::SecurityGroupIngress",
      "Properties": {
        "IpProtocol": "tcp",
        "ToPort": 8053,
        "FromPort": 8053,
        "SourceSecurityGroupId": {
          "Fn::GetAtt": [
            "NodeSG",
            "GroupId"
          ]
        },
        "GroupId": {
          "Fn::GetAtt": [
            "MasterSG",
            "GroupId"
          ]
        }
      }
    },
    "InboundRuleForNodesInternalNSUDP8053": {
      "Type": "AWS::EC2::SecurityGroupIngress",
      "Properties": {
        "IpProtocol": "udp",
        "ToPort": 8053,
        "FromPort": 8053,
        "SourceSecurityGroupId": {
          "Fn::GetAtt": [
            "NodeSG",
            "GroupId"
          ]
        },
        "GroupId": {
          "Fn::GetAtt": [
            "MasterSG",
            "GroupId"
          ]
        }
      }
    },
    "InboundRuleForMasterEtcdClientServer": {
      "Type": "AWS::EC2::SecurityGroupIngress",
      "Properties": {
        "IpProtocol": "tcp",
        "ToPort": 2379,
        "FromPort": 2379,
        "SourceSecurityGroupId": {
          "Fn::GetAtt": [
            "MasterSG",
            "GroupId"
          ]
        },
        "GroupId": {
          "Fn::GetAtt": [
            "MasterSG",
            "GroupId"
          ]
        }
      }
    },
    "InboundRuleForMasterEtcdInterServer": {
      "Type": "AWS::EC2::SecurityGroupIngress",
      "Properties": {
        "IpProtocol": "tcp",
        "ToPort": 2380,
        "FromPort": 2380,
        "SourceSecurityGroupId": {
          "Fn::GetAtt": [
            "MasterSG",
            "GroupId"
          ]
        },
        "GroupId": {
          "Fn::GetAtt": [
            "MasterSG",
            "GroupId"
          ]
        }
      }
    },
    "InboundRuleForInfraNodesHTTPS": {
      "Type": "AWS::EC2::SecurityGroupIngress",
      "Properties": {
        "IpProtocol": "tcp",
        "ToPort": 443,
        "FromPort": 443,
        "CidrIp": {
          "Ref": "inboundCIDRRangeIPv4"
        },
        "GroupId": {
          "Fn::GetAtt": [
            "InfrastructureSG",
            "GroupId"
          ]
        }
      }
    },
    "InboundRuleForInfraNodesHTTP": {
      "Type": "AWS::EC2::SecurityGroupIngress",
      "Properties": {
        "IpProtocol": "tcp",
        "ToPort": 80,
        "FromPort": 80,
        "CidrIp": {
          "Ref": "inboundCIDRRangeIPv4"
        },
        "GroupId": {
          "Fn::GetAtt": [
            "InfrastructureSG",
            "GroupId"
          ]
        }
      }
    },
    "InboundRuleForNodesHTTPS": {
      "Type": "AWS::EC2::SecurityGroupIngress",
      "Properties": {
        "IpProtocol": "tcp",
        "ToPort": 443,
        "FromPort": 443,
        "CidrIp": {
          "Ref": "inboundCIDRRangeIPv4"
        },
        "GroupId": {
          "Fn::GetAtt": [
            "NodeSG",
            "GroupId"
          ]
        }
      }
    },
    "InboundRuleForNodesSSH": {
      "Type": "AWS::EC2::SecurityGroupIngress",
      "Properties": {
        "IpProtocol": "tcp",
        "ToPort": 22,
        "FromPort": 22,
        "SourceSecurityGroupId": {
          "Fn::GetAtt": [
            "BastionSG",
            "GroupId"
          ]
        },
        "GroupId": {
          "Fn::GetAtt": [
            "NodeSG",
            "GroupId"
          ]
        }
      }
    },
    "InboundRuleForNodesKubelet": {
      "Type": "AWS::EC2::SecurityGroupIngress",
      "Properties": {
        "IpProtocol": "tcp",
        "ToPort": 10250,
        "FromPort": 10250,
        "SourceSecurityGroupId": {
          "Fn::GetAtt": [
            "NodeSG",
            "GroupId"
          ]
        },
        "GroupId": {
          "Fn::GetAtt": [
            "NodeSG",
            "GroupId"
          ]
        }
      }
    },
    "InboundRuleForNodesSDN": {
      "Type": "AWS::EC2::SecurityGroupIngress",
      "Properties": {
        "IpProtocol": "udp",
        "ToPort": 4789,
        "FromPort": 4789,
        "SourceSecurityGroupId": {
          "Fn::GetAtt": [
            "NodeSG",
            "GroupId"
          ]
        },
        "GroupId": {
          "Fn::GetAtt": [
            "NodeSG",
            "GroupId"
          ]
        }
      }
    },
    "InboundRuleForBastionSG": {
      "Type": "AWS::EC2::SecurityGroupIngress",
      "Properties": {
        "IpProtocol": "tcp",
        "ToPort": 22,
        "FromPort": 22,
        "CidrIp": {
          "Ref": "inboundCIDRRangeIPv4"
        },
        "GroupId": {
          "Fn::GetAtt": [
            "BastionSG",
            "GroupId"
          ]
        }
      }
    }
  }
}
